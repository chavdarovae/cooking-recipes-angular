import{A as c,E as m,G as M,L as b,La as u,W as i,Xa as U,Ya as D,d as v,gb as T,q as o,r as y,s as S,t as l,u as h,w as d}from"./chunk-DNCVGDDY.js";function g(r,e){let t=!e?.manualCleanup;t&&!e?.injector&&M(g);let n=t?e?.injector?.get(b)??c(b):null,p=C(e?.equal),a;e?.requireSync?a=i({kind:0},{equal:p}):a=i({kind:1,value:e?.initialValue},{equal:p});let I=r.subscribe({next:s=>a.set({kind:1,value:s}),error:s=>{if(e?.rejectErrors)throw s;a.set({kind:2,error:s})}});if(e?.requireSync&&a().kind===0)throw new h(601,!1);return n?.onDestroy(I.unsubscribe.bind(I)),u(()=>{let s=a();switch(s.kind){case 1:return s.value;case 2:throw s.error;case 0:throw new h(601,!1)}},{equal:e?.equal})}function C(r=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&r(e.value,t.value)}var O=(n=>(n.GUEST="GUEST",n.USER="USER",n.ADMIN="ADMIN",n))(O||{});var K={recipes:{path:"recipes",roles:["ADMIN","USER","GUEST"]},users:{path:"users",roles:["ADMIN"]},account:{path:"recipes/account",roles:["ADMIN","USER"],underMainMenu:"account"},login:{path:"users/login",roles:["GUEST"],underMainMenu:"account"},logout:{path:"users/logout",roles:["ADMIN","USER"],underMainMenu:"account"}};var J={pageSize:10,pageSizeOptions:[5,10,20,30]};var x=class r{transform(e,t){return e?t?e.filter(t):e:[]}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=m({name:"rcpListFilterPipe",type:r,pure:!0,standalone:!0})};var R=class r{transform(e){return e?Object.values(e):[]}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=m({name:"rcpEnumToList",type:r,pure:!0,standalone:!0})};var f=class r{static META_DATA_KEY="rcp-meta-data-list";requestMetaData;prevReqMetaData=u(()=>this.requestMetaData());constructor(){let e=null,t=sessionStorage.getItem(r.META_DATA_KEY)??"";if(t){let n=JSON.parse(t);this.isMetaDataReq(n)&&(e=n)}this.requestMetaData=i(e)}setState(e){this.requestMetaData.set(e),sessionStorage.setItem(r.META_DATA_KEY,JSON.stringify(e))}transformQueryIntoParams(e){let t=new U;for(let n in e){if(!Object.hasOwn(e,n))continue;let p=e[n];["string","number","boolean"].includes(typeof p)&&(t=t.append(n,String(p)))}return t}isMetaDataReq(e){return e&&typeof e.page=="number"&&typeof e.pageSize=="number"}static \u0275fac=function(t){return new(t||r)};static \u0275prov=d({token:r,factory:r.\u0275fac,providedIn:"root"})};var w={envName:"prod",host:"http://localhost:4200",production:!0,backendUrl:"https://cooking-recipes-nestjs.onrender.com"};var j=class r{http=c(D);router=c(T);paginationService=c(f);currUser=i(void 0);currUserSig=u(()=>this.currUser());relaodAccountsSubj=new v;accounts$=this.relaodAccountsSubj.asObservable().pipe(S(e=>this.getAllAccounts(e)),y());accountsSig=g(this.accounts$,{initialValue:{data:[],metaData:{}}});accountApi=w.backendUrl+"/api/users";currUserSotrageKey="currUser";constructor(){let e=JSON.parse(localStorage.getItem(this.currUserSotrageKey));this.setCurrUser(e)}relaodAccountList(e){this.relaodAccountsSubj.next(e)}getOwnAccount(){return this.http.get(this.accountApi+"/ownAccount").pipe(l(e=>this.setCurrUser(e)),o())}register(e){return this.http.post(this.accountApi+"/register",e).pipe(l(t=>this.setCurrUser(t)),o())}login(e){return this.http.post(this.accountApi+"/login",e).pipe(l(t=>{this.setCurrUser(t),this.router.navigateByUrl("/")}),o())}logout(){return this.http.get(this.accountApi+"/logout").pipe(l(()=>{this.setCurrUserAsGuest(),this.router.navigateByUrl("/")}),o())}getAllAccounts(e){let t=this.paginationService.transformQueryIntoParams(e);return this.http.get(this.accountApi+"/accounts",{params:t})}getAccount(e){return this.http.get(this.accountApi+"/accounts/"+e).pipe(o())}createAccount(e){return this.http.post(this.accountApi+"/accounts",e).pipe(o())}updateAccount(e){return this.http.put(this.accountApi+"/accounts/"+e.id,e).pipe(o())}deleteAccount(e){return this.http.delete(this.accountApi+"/accounts/"+e).pipe(o())}setCurrUserAsGuest(){this.setCurrUser(null)}setCurrUser(e){this.currUser.set(e),localStorage.setItem(this.currUserSotrageKey,JSON.stringify(e))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=d({token:r,factory:r.\u0275fac,providedIn:"root"})};export{g as a,O as b,K as c,J as d,x as e,R as f,w as g,f as h,j as i};
