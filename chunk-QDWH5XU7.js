import{a as I,g as b,h as U}from"./chunk-5GJRN6CO.js";import{A as s,La as A,W as p,Za as l,d as o,hb as h,q as e,r as u,s as n,t as c,w as a}from"./chunk-L3LL2VCJ.js";var g=class i{http=s(l);router=s(h);utilService=s(b);currUser=p(void 0);currUserSig=A(()=>this.currUser());relaodAccountsSubj=new o;accounts$=this.relaodAccountsSubj.asObservable().pipe(n(t=>this.getAllAccounts(t)),u());accountsSig=I(this.accounts$,{initialValue:{data:[],metaData:{}}});accountApi=U.backendUrl+"/api/users";currUserSotrageKey="currUser";constructor(){let t=JSON.parse(localStorage.getItem(this.currUserSotrageKey));this.setCurrUser(t)}relaodAccountList(t){this.relaodAccountsSubj.next(t)}getOwnAccount(){return this.http.get(this.accountApi+"/ownAccount").pipe(c(t=>this.setCurrUser(t)),e())}register(t){return this.http.post(this.accountApi+"/register",t).pipe(c(r=>this.setCurrUser(r)),e())}login(t){return this.http.post(this.accountApi+"/login",t).pipe(c(r=>{this.setCurrUser(r),this.router.navigateByUrl("/")}),e())}logout(){return this.http.get(this.accountApi+"/logout").pipe(c(()=>{this.setCurrUserAsGuest(),this.router.navigateByUrl("/")}),e())}getAllAccounts(t){let r=this.utilService.transformQueryIntoParams(t);return this.http.get(this.accountApi+"/accounts",{params:r})}getAccount(t){return this.http.get(this.accountApi+"/accounts/"+t).pipe(e())}createAccount(t){return this.http.post(this.accountApi+"/accounts",t).pipe(e())}updateAccount(t){return this.http.put(this.accountApi+"/accounts/"+t.id,t).pipe(e())}deleteAccount(t){return this.http.delete(this.accountApi+"/accounts/"+t.id).pipe(e())}setCurrUserAsGuest(){this.setCurrUser(null)}setCurrUser(t){this.currUser.set(t),localStorage.setItem(this.currUserSotrageKey,JSON.stringify(t))}static \u0275fac=function(r){return new(r||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};export{g as a};
