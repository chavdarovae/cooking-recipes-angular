import{a as J}from"./chunk-OXKQHTX4.js";import{h as G}from"./chunk-NKXRAMML.js";import{a as N}from"./chunk-MQL2ZZY7.js";import{h as Q,i as Y}from"./chunk-AUTKW4NW.js";import{A as d,Aa as A,B as V,Ba as F,Ca as w,Da as B,Ea as $,I as S,J as v,R as j,S as o,Ta as q,Y as g,_ as m,ba as h,d as M,e as O,fa as r,g as P,ga as n,gb as z,ha as u,hb as H,la as R,m as T,ma as b,na as p,o as U,qa as I,s as L,t as f,va as l,wa as _}from"./chunk-GSFQXJ43.js";var W=t=>({ui:t}),X=()=>["/recipes"],Z=t=>[t],ee=t=>({recipe:t});function te(t,i){if(t&1){let e=R();r(0,"button",11),b("click",function(){S(e);let c=p(3);return v(c.userIteractionSubj.next("deleteDialog"))}),l(1," Delete "),n(),r(2,"button",12),l(3," Edit "),n()}if(t&2){let e,s=p(3);o(2),m("routerLink",w(2,Z,"/recipes/create-edit/"+((e=s.selectedRecipeSig())==null?null:e.id)))("state",w(4,ee,s.selectedRecipeSig()))}}function ie(t,i){if(t&1){let e=R();r(0,"button",13),b("click",function(){S(e);let c=p(3);return v(c.userIteractionSubj.next("recommend"))}),l(1," Recommend "),n()}if(t&2){let e=p(3);m("disabled",e.isAlreadyRecommendedByCurrUser())}}function ne(t,i){t&1&&(r(0,"div"),l(1,"You've already recommended this recipe!"),n())}function re(t,i){if(t&1){let e=R();r(0,"article",1)(1,"h2"),l(2),n(),r(3,"div",2)(4,"div",3)(5,"span"),l(6),n(),u(7,"i",4),n(),u(8,"img",5),n(),r(9,"div",6)(10,"p"),l(11),n(),u(12,"hr"),r(13,"h3"),l(14,"Ingredients:"),n(),r(15,"p"),l(16),n(),u(17,"hr"),r(18,"h3"),l(19,"Instructions:"),n(),r(20,"p"),l(21),n(),u(22,"hr"),r(23,"div",7)(24,"button",8),l(25," Back to Recipes "),n(),g(26,te,4,6)(27,ie,2,1,"button",9),n()()(),g(28,ne,2,0,"div"),r(29,"rcp-modal",10),b("close",function(c){S(e);let x=p(2);return v(x.onModalClosed(c))}),n()}if(t&2){let e,s,c,x,y,k,D,E,C,a=p(2);o(2),_((e=a.selectedRecipeSig())==null?null:e.title),o(2),m("title",((s=a.selectedRecipeSig())==null||s.recommendList==null?null:s.recommendList.length)+"other users liked this recipe"),o(2),_((c=a.selectedRecipeSig())==null||c.recommendList==null?null:c.recommendList.length),o(2),I("src",(x=a.selectedRecipeSig())==null?null:x.image,j),I("alt",(y=a.selectedRecipeSig())==null?null:y.title),o(3),_((k=a.selectedRecipeSig())==null?null:k.description),o(5),_((D=a.selectedRecipeSig())==null?null:D.ingredients),o(5),_((E=a.selectedRecipeSig())==null?null:E.instructions),o(3),m("routerLink",F(13,X))("queryParams",a.paginationService.prevReqMetaData()),o(2),h(((C=a.authService.currUserSig())==null?null:C.id)===((C=a.selectedRecipeSig())==null?null:C.owner)?26:27),o(2),h(-1),o(),m("show",a.showModal)}}function oe(t,i){if(t&1&&(r(0,"div",0),g(1,re,30,14),n()),t&2){let e=p();o(),h(e.selectedRecipeSig()?1:-1)}}var K=class t{recipeService=d(J);alertService=d(N);router=d(z);authService=d(Y);paginationService=d(Q);id;userIteractionSubj=new M;userIteraction$;currInteraction;selectedRecipeSig=this.recipeService.selectedRecipeSig;showModal=!1;ngOnInit(){this.recipeService.selectRecipe(this.id),this.initUserInteraction()}onModalClosed(i){i&&this.userIteractionSubj.next("delete"),this.showModal=!1}isAlreadyRecommendedByCurrUser(){let i=this.selectedRecipeSig(),e=this.authService.currUserSig()?.id;return!i?.recommendList||!e?!1:i.recommendList?.includes(e)}initUserInteraction(){this.userIteraction$=this.userIteractionSubj.asObservable().pipe(U((i,e)=>e.includes("Dialog")?!1:i===e),f(i=>this.currInteraction=i),L(i=>{switch(i){case"deleteDialog":return P("deleteDialog").pipe(f(()=>this.showModal=!0));case"delete":return this.recipeService.delete(this.selectedRecipeSig()?.id).pipe(f(()=>this.router.navigateByUrl("/recipes")));case"recommend":return this.recipeService.recommend(this.selectedRecipeSig()?.id)}}),f(()=>{["deleteDialog"].includes(this.currInteraction)||this.alertService.showAlert({alert:`The recipe was successfully ${this.currInteraction}d!`,type:"success"})}),T(i=>(console.error("Recipe operation failed:",i),this.initUserInteraction(),O)))}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=V({type:t,selectors:[["rcp-recipe-detail"]],inputs:{id:"id"},standalone:!0,features:[A],decls:2,vars:5,consts:[[1,"container"],[1,"recipe"],[1,"recipe__block"],[1,"likes",3,"title"],[1,"icon","icon--help","fa-solid","fa-heart"],[3,"src","alt"],[1,"recipe__block","col","col--space-btw"],[1,"row","row--no-wrap","row--space-btw","gap-10","w100","mt-20"],[3,"routerLink","queryParams"],[1,"accent",3,"disabled"],["entity","recipe",3,"close","show"],[1,"danger",3,"click"],[1,"accent",3,"routerLink","state"],[1,"accent",3,"click","disabled"]],template:function(e,s){if(e&1&&(g(0,oe,2,1,"div",0),B(1,"async")),e&2){let c;h((c=w(3,W,$(1,1,s.userIteraction$)))?0:-1,c)}},dependencies:[H,G,q],styles:[".recipe[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:2rem;width:min(1000px,100%);height:fit-content;background:#fff;border-radius:8px;box-shadow:0 4px 8px #0000001a;padding:2rem;margin:auto;transition:transform .3s,box-shadow .3s}.recipe__block[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;overflow:hidden;position:relative}@media (min-width: 961px){.recipe__block[_ngcontent-%COMP%]{width:calc(500px - 3rem)}}.recipe[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{width:100%;background-color:#2c3e50;color:#f5f5f5;padding:.5em;border-radius:8px;text-align:center;margin-bottom:0}.likes[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px}.likes[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#dc143c;font-size:50px}.likes[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;color:#f5f5f5;font-size:20px;font-weight:600;top:50%;left:50%;transform:translate(-50%,-60%)}"]})};export{K as RecipeDetailComponent};
