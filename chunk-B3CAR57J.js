import{a as I,f as g,g as b}from"./chunk-5K5ODEUE.js";import{A as s,Ka as l,W as p,Wa as A,d as u,db as h,q as r,r as i,s as n,t as c,w as a}from"./chunk-K4TDJKIY.js";var v=class o{http=s(A);router=s(h);utilService=s(g);currUser=p(void 0);currUserSig=l(()=>this.currUser());relaodAccountsSubj=new u;accounts$=this.relaodAccountsSubj.asObservable().pipe(n(t=>this.getAllAccounts(t)),i());accountsSig=I(this.accounts$,{initialValue:[]});accountApi=b.backendUrl+"/api/users";currUserSotrageKey="currUser";constructor(){let t=JSON.parse(localStorage.getItem(this.currUserSotrageKey));this.setCurrUser(t)}relaodAccountList(t){this.relaodAccountsSubj.next(t)}getOwnAccount(){return this.http.get(this.accountApi+"/ownAccount").pipe(c(t=>this.setCurrUser(t)),r())}register(t){return this.http.post(this.accountApi+"/register",t).pipe(c(e=>this.setCurrUser(e)),r())}login(t){return this.http.post(this.accountApi+"/login",t).pipe(c(e=>{this.setCurrUser(e),this.router.navigateByUrl("/")}),r())}logout(){return this.http.get(this.accountApi+"/logout").pipe(c(()=>{this.setCurrUserAsGuest(),this.router.navigateByUrl("/")}),r())}getAllAccounts(t){return this.http.get(this.accountApi+"/accounts"+this.utilService.transformQueryIntoString(t))}getAccount(t){return this.http.get(this.accountApi+"/accounts/"+t).pipe(r())}updateAccount(t){return this.http.put(this.accountApi+"/accounts/"+t._id,t).pipe(r())}setCurrUserAsGuest(){this.setCurrUser(null)}setCurrUser(t){this.currUser.set(t),localStorage.setItem(this.currUserSotrageKey,JSON.stringify(t))}static \u0275fac=function(e){return new(e||o)};static \u0275prov=a({token:o,factory:o.\u0275fac,providedIn:"root"})};export{v as a};
