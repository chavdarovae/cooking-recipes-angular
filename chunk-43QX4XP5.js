import{A as c,E as m,G as U,L as b,La as d,W as p,Ya as x,Za as M,d as v,hb as w,q as o,r as y,s as S,t as a,u as h,w as l}from"./chunk-GIOW2ZCS.js";function I(r,e){let t=!e?.manualCleanup;t&&!e?.injector&&U(I);let n=t?e?.injector?.get(b)??c(b):null,u=C(e?.equal),i;e?.requireSync?i=p({kind:0},{equal:u}):i=p({kind:1,value:e?.initialValue},{equal:u});let A=r.subscribe({next:s=>i.set({kind:1,value:s}),error:s=>{if(e?.rejectErrors)throw s;i.set({kind:2,error:s})}});if(e?.requireSync&&i().kind===0)throw new h(601,!1);return n?.onDestroy(A.unsubscribe.bind(A)),d(()=>{let s=i();switch(s.kind){case 1:return s.value;case 2:throw s.error;case 0:throw new h(601,!1)}},{equal:e?.equal})}function C(r=Object.is){return(e,t)=>e.kind===1&&t.kind===1&&r(e.value,t.value)}var O=(n=>(n.GUEST="GUEST",n.USER="USER",n.ADMIN="ADMIN",n))(O||{});var z={recipes:{path:"recipes",roles:["ADMIN","USER","GUEST"]},users:{path:"users",roles:["ADMIN"]},account:{path:"recipes/account",roles:["ADMIN","USER"],underMainMenu:"account"},login:{path:"users/login",roles:["GUEST"],underMainMenu:"account"},logout:{path:"users/logout",roles:["ADMIN","USER"],underMainMenu:"account"}};var K={pageSize:10,pageSizeOptions:[5,10,20,30]};var j=class r{transform(e,t){return e?t?e.filter(t):e:[]}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=m({name:"appListFilterPipe",type:r,pure:!0,standalone:!0})};var D=class r{transform(e){return e?Object.values(e):[]}static \u0275fac=function(t){return new(t||r)};static \u0275pipe=m({name:"appEnumToList",type:r,pure:!0,standalone:!0})};var f=class r{transformQueryIntoParams(e){let t=new x;for(let n in e){if(!Object.hasOwn(e,n))continue;let u=e[n];["string","number","boolean"].includes(typeof u)&&(t=t.append(n,String(u)))}return t}static \u0275fac=function(t){return new(t||r)};static \u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})};var R={envName:"prod",host:"http://localhost:4200",production:!0,backendUrl:"https://cooking-recipes-nestjs.onrender.com"};var T=class r{http=c(M);router=c(w);utilService=c(f);currUser=p(void 0);currUserSig=d(()=>this.currUser());relaodAccountsSubj=new v;accounts$=this.relaodAccountsSubj.asObservable().pipe(S(e=>this.getAllAccounts(e)),y());accountsSig=I(this.accounts$,{initialValue:{data:[],metaData:{}}});accountApi=R.backendUrl+"/api/users";currUserSotrageKey="currUser";constructor(){let e=JSON.parse(localStorage.getItem(this.currUserSotrageKey));this.setCurrUser(e)}relaodAccountList(e){this.relaodAccountsSubj.next(e)}getOwnAccount(){return this.http.get(this.accountApi+"/ownAccount").pipe(a(e=>this.setCurrUser(e)),o())}register(e){return this.http.post(this.accountApi+"/register",e).pipe(a(t=>this.setCurrUser(t)),o())}login(e){return this.http.post(this.accountApi+"/login",e).pipe(a(t=>{this.setCurrUser(t),this.router.navigateByUrl("/")}),o())}logout(){return this.http.get(this.accountApi+"/logout").pipe(a(()=>{this.setCurrUserAsGuest(),this.router.navigateByUrl("/")}),o())}getAllAccounts(e){let t=this.utilService.transformQueryIntoParams(e);return this.http.get(this.accountApi+"/accounts",{params:t})}getAccount(e){return this.http.get(this.accountApi+"/accounts/"+e).pipe(o())}createAccount(e){return this.http.post(this.accountApi+"/accounts",e).pipe(o())}updateAccount(e){return this.http.put(this.accountApi+"/accounts/"+e.id,e).pipe(o())}deleteAccount(e){return this.http.delete(this.accountApi+"/accounts/"+e.id).pipe(o())}setCurrUserAsGuest(){this.setCurrUser(null)}setCurrUser(e){this.currUser.set(e),localStorage.setItem(this.currUserSotrageKey,JSON.stringify(e))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=l({token:r,factory:r.\u0275fac,providedIn:"root"})};export{I as a,O as b,z as c,K as d,j as e,D as f,f as g,R as h,T as i};
