import{a as N}from"./chunk-JFJJCYJA.js";import{a as Y}from"./chunk-B3CAR57J.js";import{a as G}from"./chunk-FEKEF5TX.js";import{h as q}from"./chunk-MI44FUCB.js";import"./chunk-5K5ODEUE.js";import{A as _,Aa as A,B as L,Ba as w,Ca as F,Da as B,I as S,J as v,R as V,Ra as $,S as l,Y as f,_ as g,ba as x,d as M,db as z,e as D,eb as H,fa as o,g as O,ga as n,ha as d,la as R,m as T,ma as b,na as s,o as U,qa as I,s as P,t as u,va as c,wa as m,za as j}from"./chunk-K4TDJKIY.js";var K=t=>({ui:t}),Q=t=>[t],W=t=>({recipe:t}),X=()=>["/recipes/"];function Z(t,i){if(t&1){let e=R();o(0,"button",9),b("click",function(){S(e);let a=s(3);return v(a.userIteractionSubj.next("deleteDialog"))}),c(1," Delete "),n(),o(2,"button",10),c(3," Edit "),n()}if(t&2){let e,r=s(3);l(2),g("routerLink",w(2,Q,"/recipes/"+((e=r.selectedRecipeSig())==null?null:e._id)+"/edit"))("state",w(4,W,r.selectedRecipeSig()))}}function ee(t,i){if(t&1){let e=R();o(0,"button",11),c(1,"Back to Recipes"),n(),o(2,"button",12),b("click",function(){S(e);let a=s(3);return v(a.userIteractionSubj.next("recommend"))}),c(3," Recommend "),n()}if(t&2){let e=s(3);g("routerLink",A(2,X)),l(2),g("disabled",e.isAlreadyRecommendedByCurrUser())}}function te(t,i){t&1&&(o(0,"div"),c(1,"You've already recommended this recipe!"),n())}function ie(t,i){if(t&1){let e=R();o(0,"article",1)(1,"h2"),c(2),n(),o(3,"div",2)(4,"div",3)(5,"span"),c(6),n(),d(7,"i",4),n(),d(8,"img",5),n(),o(9,"div",6)(10,"p"),c(11),n(),d(12,"hr"),o(13,"h3"),c(14,"Ingredients:"),n(),o(15,"p"),c(16),n(),d(17,"hr"),o(18,"h3"),c(19,"Instructions:"),n(),o(20,"p"),c(21),n(),d(22,"hr"),o(23,"div",7),f(24,Z,4,6)(25,ee,4,3),n()()(),f(26,te,2,0,"div"),o(27,"app-modal",8),b("close",function(a){S(e);let C=s(2);return v(C.onModalClosed(a))}),n()}if(t&2){let e,r,a,C,y,k,E,h,p=s(2);l(2),m((e=p.selectedRecipeSig())==null?null:e.title),l(4),m((r=p.selectedRecipeSig())==null||r.recommendList==null?null:r.recommendList.length),l(2),I("src",(a=p.selectedRecipeSig())==null?null:a.image,V),I("alt",(C=p.selectedRecipeSig())==null?null:C.title),l(3),m((y=p.selectedRecipeSig())==null?null:y.description),l(5),m((k=p.selectedRecipeSig())==null?null:k.ingredients),l(5),m((E=p.selectedRecipeSig())==null?null:E.instructions),l(3),x(((h=p.authService.currUserSig())==null?null:h._id)===((h=p.selectedRecipeSig())==null?null:h.owner)?24:25),l(2),x(-1),l(),g("show",p.showModal)}}function ne(t,i){if(t&1&&(o(0,"div",0),f(1,ie,28,10),n()),t&2){let e=s();l(),x(e.selectedRecipeSig()?1:-1)}}var J=class t{recipeService=_(G);alertService=_(N);router=_(z);authService=_(Y);id;userIteractionSubj=new M;userIteraction$;currInteraction;selectedRecipeSig=this.recipeService.selectedRecipeSig;showModal=!1;ngOnInit(){this.recipeService.selectRecipe(this.id),this.initUserInteraction()}onModalClosed(i){i&&this.userIteractionSubj.next("delete"),this.showModal=!1}isAlreadyRecommendedByCurrUser(){let i=this.selectedRecipeSig(),e=this.authService.currUserSig()?._id;return!i?.recommendList||!e?!1:i.recommendList?.flatMap(r=>r._id)?.includes(e)}initUserInteraction(){this.userIteraction$=this.userIteractionSubj.asObservable().pipe(U((i,e)=>e.includes("Dialog")?!1:i===e),u(i=>this.currInteraction=i),P(i=>{switch(i){case"deleteDialog":return O("deleteDialog").pipe(u(()=>this.showModal=!0));case"delete":return this.recipeService.delete(this.selectedRecipeSig()?._id).pipe(u(()=>this.router.navigateByUrl("/recipes")));case"recommend":return this.recipeService.recommend(this.selectedRecipeSig()?._id)}}),u(()=>{this.alertService.showAlert({alert:`The recipe was successfully ${this.currInteraction}d!`,type:"success"})}),T(i=>(console.error("Recipe operation failed:",i),this.initUserInteraction(),D)))}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=L({type:t,selectors:[["app-recipe-detail"]],inputs:{id:"id"},standalone:!0,features:[j],decls:2,vars:5,consts:[[1,"container"],[1,"recipe"],[1,"recipe__block"],[1,"likes"],[1,"fa-solid","fa-heart"],[3,"src","alt"],[1,"recipe__block","col","col--space-btw"],[1,"row","row--no-wrap","row--space-btw","w100","mt-20"],["entity","recipe",3,"close","show"],[1,"danger",3,"click"],[3,"routerLink","state"],[3,"routerLink"],[1,"accent",3,"click","disabled"]],template:function(e,r){if(e&1&&(f(0,ne,2,1,"div",0),F(1,"async")),e&2){let a;x((a=w(3,K,B(1,1,r.userIteraction$)))?0:-1,a)}},dependencies:[H,q,$],styles:[".recipe[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;gap:2rem;width:min(1000px,100%);height:fit-content;background:#fff;border-radius:8px;box-shadow:0 4px 8px #0000001a;padding:2rem;margin:auto;transition:transform .3s,box-shadow .3s}.recipe__block[_ngcontent-%COMP%]{width:100%;aspect-ratio:1;overflow:hidden;position:relative}@media (min-width: 961px){.recipe__block[_ngcontent-%COMP%]{width:calc(500px - 3rem)}}.recipe[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{width:100%;background-color:#2c3e50;color:#f5f5f5;padding:.5em;border-radius:8px;text-align:center;margin-bottom:0}.likes[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px}.likes[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#dc143c;font-size:50px}.likes[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;color:#f5f5f5;font-size:20px;font-weight:600;top:50%;left:50%;transform:translate(-50%,-60%)}"]})};export{J as RecipeDetailComponent};
